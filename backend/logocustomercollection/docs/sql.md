SELECT
CLC.CODE AS [Cari Kod],
CLC.DEFINITION_ AS [Cari Ad],
MONTH(CLF.DATE_) AS [Ay],
YEAR(CLF.DATE_) AS [Yıl],

SUM(CASE WHEN CLF.SIGN = 0 THEN CLF.AMOUNT ELSE 0 END) AS [Borç],
SUM(CASE WHEN CLF.SIGN = 1 THEN CLF.AMOUNT ELSE 0 END) AS [Alacak]

FROM
LG_002_01_CLFLINE CLF WITH (NOLOCK)
LEFT JOIN
LG_002_CLCARD CLC WITH (NOLOCK) ON CLF.CLIENTREF = CLC.LOGICALREF

WHERE
CLC.CARDTYPE <> 22
--AND CLC.CODE = '120
AND CLC.CODE LIKE '120%'
AND CLF.CANCELLED = 0
AND CLF.DATE_ >= '2024-01-01'

GROUP BY
CLC.CODE, CLC.DEFINITION_, MONTH(CLF.DATE_), YEAR(CLF.DATE_)

ORDER BY
CLC.CODE, YEAR(CLF.DATE_), MONTH(CLF.DATE_);