# zcontext_prompt/prompts/FormForgeAPI_user.txt
### **GÃ¼ncellenmiÅŸ `FormForgeAPI_user.txt`**

````
============================================================================
Ä°Å EMRÄ° v3.0: Yeni ModÃ¼l - FormForgeAPI (Tam Otomasyon)
============================================================================
TALÄ°MAT: AI, bu iÅŸ emrini ve referans gÃ¶sterilen context dosyalarÄ±nÄ±
kullanarak, sÃ¼rÃ¼kle-bÄ±rak Ã¶zellikli, yÃ¼ksek esneklikte bir dinamik
form modÃ¼lÃ¼ Ã¼retmelidir. Betikler bu dosyayÄ± okuyarak otomatik
entegrasyon ve kurulum yapacaktÄ±r.
============================================================================

--------------------------------------------------------------------------
BÃ–LÃœM A: GENEL BÄ°LGÄ°LER VE PROJE VÄ°ZYONU
--------------------------------------------------------------------------

1. META BÄ°LGÄ°LER (Whitepaper iÃ§in)

| Alan         | DeÄŸer          |
|--------------|----------------|
| module_name  | formforgeapi   |
| author       | Selim KoÃ§ak    |
| version      | 1.0.0          |
| sorumlu_ekip | Selim & Tars   |

2. Ä°Å HEDEFÄ° VE KAPSAM (Whitepaper iÃ§in)

[cite_start]Bu modÃ¼lÃ¼n amacÄ±, son kullanÄ±cÄ±larÄ±n kodlama bilgisi olmadan, sÃ¼rÃ¼kle-bÄ±rak arayÃ¼zÃ¼yle kendi veri toplama formlarÄ±nÄ± oluÅŸturmasÄ±nÄ± saÄŸlamaktÄ±r. [cite: 89, 96] [cite_start]KullanÄ±cÄ±lar, forma metin, sayÄ±, tarih gibi farklÄ± tiplerde alanlar ekleyebilmeli, bu alanlarÄ± zorunlu kÄ±labilmeli ve veri listeleme ekranÄ±nda hangi alanlarÄ±n gÃ¶rÃ¼neceÄŸini (`is_master`) belirleyebilmelidir. [cite: 96]

--------------------------------------------------------------------------
BÃ–LÃœM B: BACKEND TEKNÄ°K SPESÄ°FÄ°KASYONLARI
--------------------------------------------------------------------------

1. VERÄ°TABANI MÄ°MARÄ°SÄ° (models/formforgeapi.py)
AÅŸaÄŸÄ±daki 5 modelli, iliÅŸkisel yapÄ± **kesinlikle** bu ÅŸekilde oluÅŸturulmalÄ±dÄ±r:
1.  **Model: `Department`**
2.  **Model: `Form`**
3.  **Model: `FormField`** (`FieldType` TextChoices iÃ§ermeli)
4.  **Model: `FormSubmission`**
5.  **Model: `SubmissionValue`**

Ã–rnek Model DetaylarÄ±:
- **`FormField`**: `form` (ForeignKey to Form), `label` (CharField), `field_type` (CharField with choices), `is_required` (BooleanField), `is_master` (BooleanField, listeleme ekranÄ±nda gÃ¶sterilecek kolonlar iÃ§in), `order` (IntegerField, sÃ¼rÃ¼kle-bÄ±rak sÄ±ralamasÄ± iÃ§in).
- **`SubmissionValue`**: `submission` (ForeignKey to FormSubmission), `form_field` (ForeignKey to FormField), `value` (TextField).

2. SERVÄ°S KATMANI MANTIÄI (services/formforgeapi_service.py)
- [cite_start]`save_submission` fonksiyonu, gelen `submitted_data` dictionary'sini ayrÄ±ÅŸtÄ±rarak `SubmissionValue` kayÄ±tlarÄ± oluÅŸturmalÄ±dÄ±r. [cite: 98]

3. API (VIEWS & URLS)
- [cite_start]`Department`, `Form`, `FormField`, `FormSubmission` iÃ§in `ModelViewSet`'ler oluÅŸturulmalÄ±dÄ±r. [cite: 99]
- [cite_start]`FormSubmissionViewSet`'in `create` metodu, `save_submission` servisini Ã§aÄŸÄ±racak ÅŸekilde Ã¶zelleÅŸtirilmelidir. [cite: 99]

--------------------------------------------------------------------------
BÃ–LÃœM C: FRONTEND TEKNÄ°K SPESÄ°FÄ°KASYONLARI
--------------------------------------------------------------------------

1. BÄ°LEÅEN YAPISI VE EKRANLAR
- **`page-level/FormBuilderScreen.jsx`**: `react-beautiful-dnd` ile sÃ¼rÃ¼kle-bÄ±rak destekli form ÅŸemasÄ± oluÅŸturma ekranÄ±.
- **`page-level/FormSchemaListScreen.jsx`**: OluÅŸturulan tÃ¼m form ÅŸemalarÄ±nÄ± `reusable/SchemaTable.jsx` kullanarak listeleyen ekran.
- **`page-level/FormDataListScreen.jsx`**: Bir ÅŸemaya ait girilmiÅŸ verileri `reusable/DataTable.jsx` kullanarak listeleyen ekran.
- **`page-level/FormFillScreen.jsx`**: Bir ÅŸemaya yeni veri giriÅŸi yapmak iÃ§in kullanÄ±lan form ekranÄ±.
- **`reusable/SchemaTable.jsx`**: Verilen `schemas` prop'una gÃ¶re ÅŸemalarÄ± listeleyen, yeniden kullanÄ±labilir tablo bileÅŸeni (AÅŸaÄŸÄ±daki kod kullanÄ±lacak).
- **`reusable/DataTable.jsx`**: Verilen `columns` ve `data` proplarÄ±na gÃ¶re verileri listeleyen, yeniden kullanÄ±labilir tablo bileÅŸeni (AÅŸaÄŸÄ±daki kod kullanÄ±lacak).

2. "USTA Ä°ÅÄ°" ÅABLONLAR (BunlarÄ± DeÄŸiÅŸtirmeden DoÄŸrudan Kullan)

- **`reusable/SchemaTable.jsx`:**
  ```javascript
  // path: frontend/src/components/formforgeapi/components/reusable/SchemaTable.jsx
  import React from 'react';
  import { useTable, useSortBy } from 'react-table';
  import { Link } from 'react-router-dom';
  import styles from '../../css/formforgeapi.module.css';

  const SchemaTable = ({ schemas, loading, deleteSchema }) => {
      const data = React.useMemo(() => schemas, [schemas]);
      const columns = React.useMemo(() => [
          { Header: 'Form BaÅŸlÄ±ÄŸÄ±', accessor: 'title' },
          { Header: 'Departman', accessor: 'department_name' }, // department.name yerine department_name kullanÄ±lacak
          { Header: 'OluÅŸturan', accessor: 'created_by.username' },
          {
              Header: 'Ä°ÅŸlemler',
              accessor: 'id',
              Cell: ({ row }) => (
                  <div className={styles.actions}>
                      <Link to={`/formforgeapi/fill/${row.original.id}`}>Formu Doldur</Link>
                      <Link to={`/formforgeapi/data/${row.original.id}`}>Verileri GÃ¶r</Link>
                      <Link to={`/formforgeapi/edit/${row.original.id}`}>DÃ¼zenle</Link>
                      <button onClick={() => deleteSchema(row.original.id)} className={styles.deleteButtonSmall}>Sil</button>
                  </div>
              )
          }
      ], [deleteSchema]);

      const { getTableProps, getTableBodyProps, headerGroups, rows, prepareRow } = useTable({ columns, data }, useSortBy);
      if (loading) return <div className={styles.loading}>YÃ¼kleniyor...</div>;
      return (
          <table {...getTableProps()} className={styles.dataTable}>
              <thead>
                  {headerGroups.map(hg => (
                      <tr {...hg.getHeaderGroupProps()}>
                          {hg.headers.map(col => (
                              <th {...col.getHeaderProps(col.getSortByToggleProps())}>
                                  {col.render('Header')}
                                  <span>{col.isSorted ? (col.isSortedDesc ? ' ğŸ”½' : ' ğŸ”¼') : ''}</span>
                              </th>
                          ))}
                      </tr>
                  ))}
              </thead>
              <tbody {...getTableBodyProps()}>
                  {rows.map(row => {
                      prepareRow(row);
                      return (
                          <tr {...row.getRowProps()}>
                              {row.cells.map(cell => <td {...cell.getCellProps()}>{cell.render('Cell')}</td>)}
                          </tr>
                      );
                  })}
              </tbody>
          </table>
      );
  };
  export default SchemaTable;
````

  - **`reusable/DataTable.jsx`:**
    ```javascript
    // path: frontend/src/components/formforgeapi/components/reusable/DataTable.jsx
    import React from 'react';
    import { useTable, useSortBy } from 'react-table';
    import styles from '../../css/formforgeapi.module.css';

    const DataTable = ({ columns, data, loading }) => {
        const { getTableProps, getTableBodyProps, headerGroups, rows, prepareRow } = useTable({ columns, data }, useSortBy);
        if (loading) return <div className={styles.loading}>YÃ¼kleniyor...</div>;
        return (
            <table {...getTableProps()} className={styles.dataTable}>
                <thead>
                    {headerGroups.map(hg => (
                        <tr {...hg.getHeaderGroupProps()}>
                            {hg.headers.map(col => (
                                <th {...col.getHeaderProps(col.getSortByToggleProps())}>
                                    {col.render('Header')}
                                    <span>{col.isSorted ? (col.isSortedDesc ? ' ğŸ”½' : ' ğŸ”¼') : ''}</span>
                                </th>
                            ))}
                        </tr>
                    ))}
                </thead>
                <tbody {...getTableBodyProps()}>
                    {rows.map(row => {
                        prepareRow(row);
                        return (
                            <tr {...row.getRowProps()}>
                                {row.cells.map(cell => <td {...cell.getCellProps()}>{cell.render('Cell')}</td>)}
                            </tr>
                        );
                    })}
                </tbody>
            </table>
        );
    };
    export default DataTable;
    ```

<!-- end list -->

3.  ANAHTAR Ã–ZELLÄ°KLER VE Ä°NTERAKTÄ°VÄ°TE

<!-- end list -->

  - [cite\_start]**SÃ¼rÃ¼kle-BÄ±rak Form TasarÄ±mÄ±:** `FormBuilderScreen.jsx` iÃ§inde `react-beautiful-dnd` kullanarak form alanlarÄ±nÄ±n yeniden sÄ±ralanabilmesi saÄŸlanmalÄ±dÄ±r. [cite: 130]
  - [cite\_start]**Dinamik Veri Tablosu:** `FormDataListScreen.jsx`, backend'den gelen form ÅŸemasÄ±ndaki `is_master: true` olan alanlarÄ± bularak `DataTable` iÃ§in kolonlarÄ± dinamik olarak oluÅŸturmalÄ±dÄ±r. [cite: 133]
  - [cite\_start]**Veri YapÄ±sÄ± SÃ¶zleÅŸmesi:** Frontend ve backend arasÄ±ndaki veri alÄ±ÅŸveriÅŸi, bu dÃ¶kÃ¼manÄ±n Ã¶nceki versiyonunda tanÄ±mlanan payload yapÄ±larÄ±na harfiyen uymalÄ±dÄ±r. [cite: 100, 101, 102, 103, 104]

-----

## BÃ–LÃœM D: ZORUNLU Ã‡IKTI FORMATI (DEÄÄ°ÅTÄ°RMEYÄ°N)

Her bir dosya, \#\#\#/tam/dosya/yolu/ornek.py\#\#\# ve \#\#\#END\_OF\_FILE\#\#\#
ayraÃ§larÄ±yla sarmalanmalÄ±dÄ±r. Bu kurala harfiyen uyulmalÄ±, ayraÃ§lar
arasÄ±na baÅŸka hiÃ§bir metin veya aÃ§Ä±klama eklenmemelidir.

-----

## BÃ–LÃœM E: FRONTEND BAÄIMLILIKLARI (npm install iÃ§in)

# [Bu bÃ¶lÃ¼mdeki paketler gen\_api.sh tarafÄ±ndan otomatik olarak kurulacaktÄ±r.

# Paketleri boÅŸlukla ayÄ±rarak tek satÄ±rda yazÄ±n.]

react-beautiful-dnd react-table@7 react-hook-form yup @hookform/resolvers file-saver react-toastify

```